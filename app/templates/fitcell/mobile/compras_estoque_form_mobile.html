<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Nova Compra</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">


<style>
body{background:#eef4fb;}
.mobile-container{padding:12px;max-width:540px;margin:auto;}
.card-item{background:#fff;border-radius:16px;padding:12px;box-shadow:0 6px 18px rgba(0,0,0,.08);margin-bottom:12px;}
</style>
</head>

<body>

<div class="mobile-container">

<div class="d-flex justify-content-between align-items-center mb-3">
<strong style="font-size:18px">Nova Compra</strong>

<a href="{{ url_for('routes.fitcell_listar_compras_estoque_mobile') }}"
class="btn btn-secondary btn-sm">Voltar</a>
</div>

<form method="POST">

{{ form.csrf_token }}

<div class="card-item">

{{ form.fornecedor_id.label(class="form-label") }}
{{ form.fornecedor_id(class="form-control mb-2") }}

{{ form.observacao.label(class="form-label") }}
{{ form.observacao(class="form-control") }}

</div>

<div class="d-flex justify-content-between align-items-center mb-2">
<strong>Itens</strong>

<button type="button" onclick="adicionarLinha()" class="btn btn-success btn-sm">
<i class="fa fa-plus"></i>
</button>
</div>

<div id="itens"></div>

<button class="btn btn-success w-100 mt-3">
Salvar Compra
</button>

</form>

</div>

<script>

function adicionarLinha(){

const div=document.createElement("div");
div.className="card-item";

div.innerHTML=`

<select name="peca_id[]" class="form-control mb-2" required>
<option value="">Selecione a peça</option>
{% for p in pecas %}
<option value="{{ p.id }}">
{{ p.codigo_interno }} - {{ p.nome }}
</option>
{% endfor %}
</select>

<div class="row">

<div class="col-6">
<input type="number" name="quantidade[]" class="form-control" placeholder="Qtd" min="1" required>
</div>

<div class="col-6">
<input type="number" name="custo_unitario[]" step="0.01" min="0" class="form-control" placeholder="Custo Unitário" required>
</div>

</div>

<button type="button"
class="btn btn-outline-danger btn-sm mt-2 w-100"
onclick="this.parentNode.remove()">
Remover
</button>

`;

document.getElementById("itens").appendChild(div);
}

</script>

</body>
</html>
